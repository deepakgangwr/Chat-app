import{c as f,a as C,u,b as v,V as j,j as e,r as c,M as U}from"./index-Ij_dlwAs.js";import{M as z}from"./mail-DjYZc8QE.js";import{X as M,S as L}from"./x-DVjWVDuf.js";import{M as y}from"./message-square-aZTlvjmv.js";/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=f("Bolt",[["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=f("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=f("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=f("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=f("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),g=C((s,a)=>({messages:[],users:[],selectedUser:null,isUsersLoading:!1,isMessagesLoading:!1,getUsers:async()=>{s({isUsersLoading:!0});try{const t=await v.get("/messages/users");s({users:t.data})}catch(t){j.error(t.response.data.message)}finally{s({isUsersLoading:!1})}},getMessages:async t=>{s({isMessagesLoading:!0});try{const r=await v.get(`/messages/${t}`);s({messages:r.data})}catch(r){j.error(r.response.data.message)}finally{s({isMessagesLoading:!1})}},sendMessage:async t=>{const{selectedUser:r,messages:n}=a();try{const o=await v.post(`/messages/send/${r._id}`,t);s({messages:[...n,o.data]})}catch(o){j.error(o.response.data.message)}},subscribeToMessages:()=>{const{selectedUser:t}=a();if(!t)return;u.getState().socket.on("newMessage",n=>{n.senderId===t._id&&s({messages:[...a().messages,n]})})},unsubscribeFromMessages:()=>{u.getState().socket.off("newMessage")},setSelectedUser:t=>s({selectedUser:t})})),P=()=>{const s=Array(8).fill(null);return e.jsxs("aside",{className:`h-full w-20 lg:w-72 border-r border-base-300 
    flex flex-col transition-all duration-200`,children:[e.jsx("div",{className:"border-b border-base-300 w-full p-5",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-6 h-6"}),e.jsx("span",{className:"font-medium hidden lg:block",children:"Contacts"})]})}),e.jsx("div",{className:"overflow-y-auto w-full py-3",children:s.map((a,t)=>e.jsxs("div",{className:"w-full p-3 flex items-center gap-3",children:[e.jsx("div",{className:"relative mx-auto lg:mx-0",children:e.jsx("div",{className:"skeleton size-12 rounded-full"})}),e.jsxs("div",{className:"hidden lg:block text-left min-w-0 flex-1",children:[e.jsx("div",{className:"skeleton h-4 w-32 mb-2"}),e.jsx("div",{className:"skeleton h-3 w-16"})]})]},t))})]})},F=()=>{const{getUsers:s,users:a,selectedUser:t,setSelectedUser:r,isUsersLoading:n}=g(),{onlineUsers:o}=u(),[d,x]=c.useState(!1),[i,m]=c.useState("");c.useEffect(()=>{s()},[s]);const h=c.useMemo(()=>{const l=d?a.filter(b=>o.includes(b._id)):a;if(!i.trim())return l;const N=i.toLowerCase();return l.filter(b=>(b.fullName||"").toLowerCase().includes(N)||(b.email||"").toLowerCase().includes(N))},[a,d,o,i]);return n?e.jsx(P,{}):e.jsxs("aside",{className:"h-full w-20 lg:w-80 border-r border-white/20 bg-white/60 backdrop-blur-2xl shadow-xl flex flex-col transition-all duration-300",children:[e.jsxs("div",{className:"border-b border-white/20 w-full p-5 bg-gradient-to-r from-indigo-50/80 to-fuchsia-50/80 backdrop-blur-md",children:[e.jsxs("div",{className:"hidden lg:flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"size-6 text-indigo-600"}),e.jsx("span",{className:"font-semibold text-slate-800 text-lg",children:"Contacts"})]}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[Math.max(o.length-1,0)," online now"]})]}),e.jsxs("div",{className:"text-xs px-3 py-1 rounded-full bg-white/70 border border-white/40 shadow-sm",children:[a.length," contacts"]})]}),e.jsx("div",{className:"hidden lg:block mt-4",children:e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 rounded-full bg-white/70 border border-white/40 shadow-inner focus-within:ring-2 focus-within:ring-indigo-400 transition",children:[e.jsx(A,{className:"size-4 text-slate-500"}),e.jsx("input",{type:"text",className:"bg-transparent outline-none text-sm w-full placeholder-slate-400",placeholder:"Search contacts...",value:i,onChange:l=>m(l.target.value)})]})}),e.jsx("div",{className:"mt-3 hidden lg:flex items-center gap-2",children:e.jsxs("label",{className:"cursor-pointer flex items-center gap-2 text-sm text-slate-600",children:[e.jsx("input",{type:"checkbox",checked:d,onChange:l=>x(l.target.checked),className:"checkbox checkbox-sm rounded-full border-slate-300"}),"Show online only"]})})]}),e.jsxs("div",{className:"overflow-y-auto w-full py-4 px-2 space-y-2",children:[h.map(l=>e.jsxs("button",{onClick:()=>r(l),className:`w-full flex items-center gap-4 p-3 rounded-2xl transition-all duration-200 
              ${(t==null?void 0:t._id)===l._id?"bg-gradient-to-r from-indigo-100/90 to-fuchsia-100/90 ring-2 ring-indigo-200 shadow-md":"hover:bg-white/70 hover:shadow-sm"}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:l.profilePic||"/avatar.png",alt:l.fullName,className:"size-12 object-cover rounded-full border-2 border-white shadow-md"}),o.includes(l._id)&&e.jsx("span",{className:"absolute bottom-0 right-0 size-3 bg-green-500 rounded-full ring-2 ring-white animate-pulse"})]}),e.jsxs("div",{className:"hidden lg:block text-left min-w-0",children:[e.jsx("div",{className:"font-medium text-slate-800 truncate",children:l.fullName}),e.jsxs("div",{className:"text-xs text-slate-500 truncate flex items-center gap-1",children:[e.jsx(z,{className:"size-3 text-slate-400"}),e.jsx("span",{className:"truncate",children:l.email||""})]})]})]},l._id)),h.length===0&&e.jsx("div",{className:"text-center text-slate-400 py-6",children:"No users found"})]})]})},k=()=>{const{selectedUser:s,setSelectedUser:a}=g(),{onlineUsers:t}=u();return e.jsx("div",{className:"p-2.5 border-b border-base-300/70 bg-base-100/60 backdrop-blur",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"size-10 rounded-full relative border shadow-sm",children:e.jsx("img",{src:s.profilePic||"/avatar.png",alt:s.fullName})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:s.fullName}),e.jsxs("p",{className:"text-sm text-base-content/70 flex items-center gap-2",children:[t.includes(s._id)?"Online":"Offline",e.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${t.includes(s._id)?"bg-green-500":"bg-zinc-400"} animate-pulseDot`})]})]})]}),e.jsx("button",{onClick:()=>a(null),children:e.jsx(M,{})})]})})},S=()=>{const[s,a]=c.useState(""),[t,r]=c.useState(null),n=c.useRef(null),{sendMessage:o}=g(),d=m=>{const h=m.target.files[0];if(!h.type.startsWith("image/")){j.error("Please select an image file");return}const l=new FileReader;l.onloadend=()=>{r(l.result)},l.readAsDataURL(h)},x=()=>{r(null),n.current&&(n.current.value="")},i=async m=>{if(m.preventDefault(),!(!s.trim()&&!t))try{await o({text:s.trim(),image:t}),a(""),r(null),n.current&&(n.current.value="")}catch(h){console.error("Failed to send message:",h)}};return e.jsxs("div",{className:"p-4 w-full",children:[t&&e.jsx("div",{className:"mb-3 flex items-center gap-2",children:e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:t,alt:"Preview",className:"w-20 h-20 object-cover rounded-lg border border-zinc-700"}),e.jsx("button",{onClick:x,className:`absolute -top-1.5 -right-1.5 w-5 h-5 rounded-full bg-base-300\r
              flex items-center justify-center`,type:"button",children:e.jsx(M,{className:"size-3"})})]})}),e.jsxs("form",{onSubmit:i,className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx("input",{type:"text",className:"w-full input input-bordered rounded-lg input-sm sm:input-md",placeholder:"Type a message...",value:s,onChange:m=>a(m.target.value)}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",ref:n,onChange:d})]}),e.jsx("button",{type:"submit",className:"btn btn-sm btn-circle",disabled:!s.trim()&&!t,children:e.jsx(_,{size:22})})]})]})},O=()=>{const s=Array(6).fill(null);return e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:s.map((a,t)=>e.jsxs("div",{className:`chat ${t%2===0?"chat-start":"chat-end"}`,children:[e.jsx("div",{className:"chat-image avatar",children:e.jsx("div",{className:"size-10 rounded-full",children:e.jsx("div",{className:"skeleton w-full h-full rounded-full"})})}),e.jsx("div",{className:"chat-header mb-1",children:e.jsx("div",{className:"skeleton h-4 w-16"})}),e.jsx("div",{className:"chat-bubble bg-transparent p-0",children:e.jsx("div",{className:"skeleton h-16 w-[200px]"})})]},t))})};function R(s){return new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}const E=()=>{const{messages:s,getMessages:a,isMessagesLoading:t,selectedUser:r,subscribeToMessages:n,unsubscribeFromMessages:o}=g(),{authUser:d}=u(),x=c.useRef(null);return c.useEffect(()=>(a(r._id),n(),()=>o()),[r._id,a,n,o]),c.useEffect(()=>{x.current&&s&&x.current.scrollIntoView({behavior:"smooth"})},[s]),t?e.jsxs("div",{className:"flex-1 flex flex-col overflow-auto bg-gradient-to-br from-indigo-50 via-white to-fuchsia-50",children:[e.jsx(k,{}),e.jsx(O,{}),e.jsx(S,{})]}):e.jsxs("div",{className:"flex-1 flex flex-col overflow-auto bg-gradient-to-br from-indigo-50 via-white to-fuchsia-50",children:[e.jsx("div",{className:"sticky top-0 z-20 bg-white/60 backdrop-blur-lg border-b border-white/20 shadow-sm",children:e.jsx(k,{})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:s.map((i,m)=>e.jsxs("div",{className:`flex items-start gap-3 animate-fadeIn ${i.senderId===d._id?"justify-end":"justify-start"}`,ref:m===s.length-1?x:null,children:[i.senderId!==d._id&&e.jsx("div",{className:"h-10 w-10 rounded-full border-2 border-fuchsia-300 shadow-md overflow-hidden hover:scale-105 transition-transform",children:e.jsx("img",{src:r.profilePic||"/avatar.png",alt:"profile",className:"h-full w-full object-cover"})}),e.jsxs("div",{className:`max-w-[70%] rounded-2xl px-10 py-0.0 shadow-md text-sm sm:text-base leading-relaxed ${i.senderId===d._id?"bg-gradient-to-br from-indigo-500 to-fuchsia-500 text-white rounded-br-none":"bg-white/80 backdrop-blur-md border border-gray-200 rounded-bl-none"}`,children:[i.image&&e.jsx("img",{src:i.image,alt:"Attachment",className:"sm:max-w-[220px] rounded-xl mb-2 shadow-sm"}),i.text&&e.jsx("p",{children:i.text}),e.jsx("div",{className:`text-[12px] mt-0 opacity-70 ${i.senderId===d._id?"text-gray-200":"text-gray-500"}`,children:R(i.createdAt)})]}),i.senderId===d._id&&e.jsx("div",{className:"h-10 w-10 rounded-full border-2 border-indigo-400 shadow-md overflow-hidden hover:scale-105 transition-transform",children:e.jsx("img",{src:d.profilePic||"/avatar.png",alt:"profile",className:"h-full w-full object-cover"})})]},i._id))}),e.jsx("div",{className:"sticky bottom-0 bg-white/70 backdrop-blur-md border-t border-white/20 shadow-lg p-2",children:e.jsx(S,{})})]})},p=({icon:s,title:a,desc:t,color:r})=>e.jsx("div",{className:"rounded-2xl border border-white/20 bg-white/60 backdrop-blur-xl p-6 shadow-md hover:shadow-xl hover:-translate-y-1 transition-all duration-300",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center shadow-inner ${r}`,children:s}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 text-lg",children:a}),e.jsx("div",{className:"text-sm text-slate-600",children:t})]})]})}),q=()=>e.jsxs("div",{className:"relative w-full flex flex-1 flex-col items-center justify-center p-10 bg-gradient-to-b from-indigo-50 via-white to-fuchsia-50 overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 -z-10",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.05] bg-[radial-gradient(circle,black_1px,transparent_1px)] [background-size:24px_24px]"}),e.jsx("div",{className:"absolute -top-32 -left-32 w-72 h-72 bg-indigo-300 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-fuchsia-300 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse delay-700"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-80 h-80 bg-purple-300 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse delay-1000"})]}),e.jsxs("div",{className:"w-full max-w-5xl",children:[e.jsxs("div",{className:"text-center relative z-10",children:[e.jsx("div",{className:"mx-auto w-20 h-20 rounded-2xl bg-gradient-to-tr from-indigo-400 to-fuchsia-400 flex items-center justify-center shadow-lg",children:e.jsx(y,{className:"w-10 h-10 text-white"})}),e.jsx("h2",{className:"text-4xl sm:text-10xl font-extrabold mt-100 tracking-tight bg-gradient-to-r from-indigo-500 via-purple-500 to-fuchsia-500 bg-clip-text text-transparent drop-shadow-sm",children:"Welcome to Connectly"}),e.jsx("p",{className:"text-slate-600 mt-5 text-lg max-w-2xl mx-auto",children:"Select a contact from the sidebar to start chatting. Your conversations will appear here with real-time updates and a premium chat experience."})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 lg:grid-cols-2 gap-6 mt-12 relative z-10",children:[e.jsx(p,{icon:e.jsx(y,{className:"w-6 h-6 text-white"}),title:"Real-time Messaging",desc:"Instant delivery with live updates",color:"bg-gradient-to-tr from-emerald-400 to-emerald-600 text-white"}),e.jsx(p,{icon:e.jsx(w,{className:"w-6 h-6 text-white"}),title:"Online Status",desc:"See who's available to chat",color:"bg-gradient-to-tr from-purple-400 to-purple-600 text-white"}),e.jsx(p,{icon:e.jsx(I,{className:"w-6 h-6 text-white"}),title:"Lightning Fast",desc:"Optimized for speed and performance",color:"bg-gradient-to-tr from-orange-400 to-orange-600 text-white"}),e.jsx(p,{icon:e.jsx(L,{className:"w-6 h-6 text-white"}),title:"Secure Chats",desc:"End-to-end encrypted messages",color:"bg-gradient-to-tr from-indigo-400 to-indigo-600 text-white"})]})]})]}),W=()=>{const{selectedUser:s}=g();return e.jsxs("div",{className:"relative h-screen bg-gradient-to-b from-[#f7faff] via-[#f3f6fb] to-[#eef2f7]",children:[e.jsx("div",{className:"pointer-events-none absolute -top-24 left-1/2 -translate-x-1/2 h-80 w-80 rounded-full bg-indigo-400/20 blur-3xl"}),e.jsx("div",{className:"pointer-events-none absolute bottom-0 right-0 h-80 w-80 rounded-full bg-fuchsia-400/20 blur-3xl"}),e.jsx("div",{className:"flex items-center justify-center pt-20 px-4",children:e.jsxs("div",{className:"relative w-full max-w-6xl h-[calc(100vh-8rem)] rounded-3xl bg-white/80 border border-slate-200/70 shadow-[0_10px_50px_-20px_rgba(0,0,0,0.25)] overflow-hidden",children:[e.jsx("div",{className:"pointer-events-none absolute top-3 left-3 flex items-center justify-center w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-fuchsia-500 shadow-lg",children:e.jsx(U,{className:"w-6 h-6 text-white opacity-90"})}),e.jsx("div",{className:"pointer-events-none absolute top-3 right-3 flex items-center justify-center w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500 to-blue-500 shadow",children:e.jsx($,{className:"w-5 h-5 text-white opacity-90"})}),e.jsx("div",{className:"pointer-events-none absolute bottom-3 left-3 flex items-center justify-center w-10 h-10 rounded-xl bg-gradient-to-br from-fuchsia-500 to-rose-500 shadow",children:e.jsx(w,{className:"w-5 h-5 text-white opacity-90"})}),e.jsx("div",{className:"pointer-events-none absolute bottom-3 right-3 flex items-center justify-center w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-500 to-indigo-500 shadow-lg",children:e.jsx(_,{className:"w-6 h-6 text-white opacity-90"})}),e.jsxs("div",{className:"flex h-full",children:[e.jsx(F,{}),s?e.jsx(E,{}):e.jsx(q,{})]})]})})]})};export{W as default};
